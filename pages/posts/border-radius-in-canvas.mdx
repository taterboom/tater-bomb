import Playground, { CodeEditor } from "../../components/Playground"
import {
  roundRectByArc,
  roundRectByQuadraticCurve,
  CanvasExample,
} from "../../components/PostAssets/border-radius-in-canvas"

# 如何在 Canvas 中画出圆角

## QuadraticCurve 二次贝塞尔曲线

<CodeEditor
  code={`function roundRectByQuadraticCurve(
  ctx: CanvasRenderingContext2D,
  x: number,
  y: number,
  width: number,
  height: number,
  radius: number = 0
) {
  ctx.beginPath()
  ctx.moveTo(x + radius, y)
  ctx.lineTo(x + width - radius, y)
  ctx.quadraticCurveTo(x + width, y, x + width, y + radius)
  ctx.lineTo(x + width, y + height - radius)
  ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height)
  ctx.lineTo(x + radius, y + height)
  ctx.quadraticCurveTo(x, y + height, x, y + height - radius)
  ctx.lineTo(x, y + radius)
  ctx.quadraticCurveTo(x, y, x + radius, y)
  ctx.closePath()
}`}
/>

<Playground
  className="sm:!grid-cols-[1fr_332px]"
  scope={{ roundRectByQuadraticCurve, CanvasExample }}
>
  {`() => {
    const rectSize = 300
    const borderSize = 4
    const borderRidus = 100 // set 150 to check the circle shape
    const color = 'rgba(255, 0, 0, 0.6)'
    const canvasRef = React.useRef(null)
    React.useEffect(() => {
        const canvas = canvasRef.current
        const ctx = canvas.getContext("2d")
        ctx.strokeStyle = color
        ctx.lineWidth = borderSize
        roundRectByQuadraticCurve(
            ctx,
            borderSize / 2,
            borderSize / 2,
            rectSize - borderSize,
            rectSize - borderSize,
            borderRidus,
        )
        ctx.stroke()
    }, [])
    return <CanvasExample ref={canvasRef} rectSize={rectSize} borderSize={borderSize} borderRidus={borderRidus} color={color}/>
}`}
</Playground>

## Arc 圆弧

<CodeEditor
  code={`function roundRectByArc(
  ctx: CanvasRenderingContext2D,
  x: number,
  y: number,
  width: number,
  height: number,
  radius: number = 0
) {
  ctx.beginPath()
  ctx.moveTo(x + radius, y)
  ctx.arcTo(x + width, y, x + width, y + height, radius)
  ctx.arcTo(x + width, y + height, x, y + height, radius)
  ctx.arcTo(x, y + height, x, y, radius)
  ctx.arcTo(x, y, x + width, y, radius)
  ctx.closePath()
}`}
/>

<Playground className="sm:!grid-cols-[1fr_332px]" scope={{ roundRectByArc, CanvasExample }}>
  {`() => {
    const rectSize = 300
    const borderSize = 4
    const borderRidus = 100 // set 150 to check the circle shape
    const color = 'rgba(255, 0, 0, 0.6)'
    const canvasRef = React.useRef(null)
    React.useEffect(() => {
        const canvas = canvasRef.current
        const ctx = canvas.getContext("2d")
        ctx.strokeStyle = color
        ctx.lineWidth = borderSize
        roundRectByArc(
            ctx,
            borderSize / 2,
            borderSize / 2,
            rectSize - borderSize,
            rectSize - borderSize,
            borderRidus,
        )
        ctx.stroke()
    }, [])
    return <CanvasExample ref={canvasRef} rectSize={rectSize} borderSize={borderSize} borderRidus={borderRidus} color={color}/>
}`}
</Playground>
